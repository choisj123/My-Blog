(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[246],{6432:function(e,t,a){Promise.resolve().then(a.bind(a,3842))},3842:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var s=a(7437),r=a(2265),n=a(9376),l=a(605),o=a(3464);function c(e){var t,a;let{params:c}=e,[d,i]=(0,r.useState)(null),[u,m]=(0,r.useState)(""),[x,h]=(0,r.useState)(!1),[p,b]=(0,r.useState)(""),[g,v]=(0,r.useState)(""),f=(0,n.useRouter)(),{data:y}=(0,l.useSession)();(0,r.useEffect)(()=>{j()},[c.id]);let j=async()=>{try{let e=await o.Z.get("/api/post/".concat(c.id));i(e.data),b(e.data.title),v(e.data.content)}catch(e){console.error("게시글 불러오기 실패:",e)}},N=async e=>{if(e.preventDefault(),!y){alert("댓글을 작성하려면 로그인이 필요합니다.");return}if(!u){alert("댓글을 작성해주세요.");return}try{await o.Z.post("/api/comment",{content:u,post_no:parseInt(c.id)}),m(""),j()}catch(e){console.error("댓글 작성 실패:",e),alert("댓글 작성에 실패했습니다.")}},w=async()=>{if(confirm("정말로 이 게시글을 삭제하시겠습니까?"))try{await o.Z.delete("/api/post/".concat(c.id)),alert("게시글이 삭제되었습니다."),f.push("/board")}catch(e){console.error("게시글 삭제 실패:",e),alert("게시글 삭제에 실패했습니다.")}},_=async e=>{e.preventDefault();try{await o.Z.put("/api/post/".concat(d.post_no),{title:p,content:g}),h(!1),j()}catch(e){console.error("게시글 수정 실패:",e),alert("게시글 수정에 실패했습니다.")}};if(!d)return(0,s.jsx)("div",{children:"로딩 중..."});let S=(null==y?void 0:null===(t=y.user)||void 0===t?void 0:t.userNo)===d.user_no.toString(),C=null==y?void 0:null===(a=y.user)||void 0===a?void 0:a.isAdmin;return(0,s.jsxs)("div",{className:"max-w-4xl mx-auto mt-8",children:[x?(0,s.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,s.jsx)("input",{type:"text",value:p,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border rounded"}),(0,s.jsx)("textarea",{value:g,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 border rounded h-40"}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 mr-2",children:"수정 완료"}),(0,s.jsx)("button",{onClick:()=>h(!1),className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600",children:"취소"})]})]}):(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 mb-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:d.title}),(S||C)&&(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("button",{onClick:()=>h(!0),className:"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600",children:"수정"}),(0,s.jsx)("button",{onClick:w,className:"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600",children:"삭제"})]})]}),(0,s.jsxs)("p",{className:"text-gray-600 mb-4",children:["작성자: ",d.user.name," | 작성일:"," ",new Date(d.create_dt).toLocaleDateString()]}),(0,s.jsx)("div",{className:"prose mb-6",children:d.content})]}),(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Comments"}),d.comments&&d.comments.length>0?d.comments.map(e=>(0,s.jsxs)("div",{className:"bg-gray-100 p-4 mb-4 rounded",children:[(0,s.jsx)("p",{children:e.content}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["By ",e.user.name," on"," ",new Date(e.create_dt).toLocaleDateString()]})]},e.comment_no)):(0,s.jsx)("p",{children:"아직 댓글이 없습니다."}),(0,s.jsxs)("form",{onSubmit:N,className:"mt-6",children:[(0,s.jsx)("textarea",{className:"w-full p-2 border rounded",rows:"4",placeholder:"Add a comment...",value:u,onChange:e=>m(e.target.value)}),(0,s.jsx)("button",{type:"submit",className:"mt-2 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"댓글 작성"})]})]})]})}}},function(e){e.O(0,[605,301,971,117,744],function(){return e(e.s=6432)}),_N_E=e.O()}]);